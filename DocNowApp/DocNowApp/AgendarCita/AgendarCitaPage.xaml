<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="DocNowApp.AgendarCita.AgendarCitaPage"
             Title="AgendarCitaPage">
    <!--xmlns:navegacion="clr-namespace:DocNowApp.Navegacion"
             xmlns:paciente="clr-namespace:DocNowApp.PacientePages">-->
    <ScrollView>
        <VerticalStackLayout>
            <!--<navegacion:BotonRegresar Ruta="PacientePrincipalPage" />-->
            <Label 
                Text="Elija un médico y un consultorio en el cual agendar su cita"
                VerticalOptions="Center" 
                HorizontalOptions="Center"
                FontAttributes="Bold"
                FontSize="20"
                Margin="0,20,0,20"/>

            <HorizontalStackLayout Spacing="8" HorizontalOptions="Center" Margin="0,0,0,20">
                <SearchBar x:Name="sbBarraDeBusqueda" Placeholder="Buscar..." 
                           SearchCommandParameter="{Binding Text, Source={x:Reference sbBarraDeBusqueda}}"
                           TextChanged="sbBarraDeBusqueda_TextChanged"
                           FontSize="12"
                           MaxLength="255"
                           HeightRequest="20"
                           WidthRequest="250"
                           VerticalOptions="End"/>

                <Picker x:Name="pickerFiltro"
                        Title="Filtrar por:"
                        SelectedIndexChanged="pickerFiltro_SelectedIndexChanged"
                        HeightRequest="70"
                        WidthRequest="250"
                        VerticalOptions="End"/>
            </HorizontalStackLayout>


            <Border Stroke="Orange"
                    Background="Transparent"
                    StrokeThickness="2"
                    WidthRequest="750"
                    StrokeShape="RoundRectangle 16"
                    Padding="8">
                <CollectionView x:Name="collectionMedicoConsultorio"
                                IsEnabled="True"
                                SelectionMode="Single"
                                HeightRequest="180"
                                WidthRequest="700"
                                SelectionChanged="collectionMedicoConsultorio_SelectionChanged">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Margin="4" Padding="10" CornerRadius="8" BorderColor="Aqua" Background="Transparent" HasShadow="True">
                                <Grid Padding="8" ColumnDefinitions="*,Auto">
                                    <StackLayout>
                                        <Label Text="{Binding NombreMedico}" FontAttributes="Bold" />
                                        <Label Text="{Binding NombreEspecialidad}" FontSize="Small" TextColor="Gray"/>
                                        <Label Text="{Binding NombreConsultorio}" FontSize="Small" TextColor="Gray"/>
                                        <Label Text="{Binding Telefono}" FontSize="Small" TextColor="Gray"/>
                                        <Label Text="{Binding Direccion}" FontSize="Small" TextColor="Gray"/>
                                        <Label Text="{Binding DiasTexto}" FontSize="Small" TextColor="Gray"/>
                                    </StackLayout>
                                </Grid>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Border>

            <StackLayout Grid.Row="1" Grid.ColumnSpan="3" Orientation="Horizontal" HorizontalOptions="Center" Margin="0,30,0,0">
                <Button x:Name="btnAceptar" Text="Aceptar elección" Clicked="btnAceptar_Clicked" IsEnabled="True" />
                <Button x:Name="btnCancelar" Text="Cambiar elección" Clicked="btnCancelar_Clicked" IsEnabled="False" Margin="50,0,0,0" />
            </StackLayout>

            <Picker x:Name="pickerMotivoConsulta"
                    Title="Seleccione el motivo de su visita"
                    IsEnabled="False"
                    ItemDisplayBinding="{Binding DescripcionMotivo}"
                    HeightRequest="70"
                    WidthRequest="350"
                    VerticalOptions="End"
                    Margin="0,30,0,0"/>


            <Label Text="Seleccione el día que desea agendar su cita"
                   HorizontalOptions="Center"
                   Margin="0,30,0,0"/>
            <DatePicker
                 x:Name="dateFechaCita"
                 FontFamily="Arial"
                 FontSize="12"
                 Format="dd/mm/yyyy"
                 IsEnabled="False"
                 DateSelected="dateFechaCita_DateSelected"
                 WidthRequest="200"
                 Grid.Column="0"
                 VerticalOptions="Center"
                 Margin="0,10,0,20"/>

            <Grid ColumnDefinitions="Auto,Auto"
                  HorizontalOptions="Center"
                  ColumnSpacing="30"
                  Margin="0,0,0,40">

                <Button x:Name="btnElegirHorario"
                        Text="Elegir horario"
                        IsEnabled="False"
                        Clicked="btnElegirHorario_Clicked"
                        HeightRequest="50"
                        WidthRequest="130"
                        Margin="0,0,0,0"/>

                <StackLayout Grid.Column="1" HorizontalOptions="Center">
                    <Label Text="HORARIO SELECCIONADO:"
                           FontAttributes="Bold"
                           FontSize="15"
                           Padding="10"/>
                    <Label x:Name="lblTurnoSeleccionado"
                           Text="Horario no seleccionado"
                           Padding="10"/>
                </StackLayout>
            </Grid>

            <Button x:Name="btnAgendarCita"
                    Text="Agendar cita"
                    IsEnabled="False"
                    Clicked="btnAgendarCita_Clicked"
                    HeightRequest="50"
                    WidthRequest="130" />
        </VerticalStackLayout>
    </ScrollView>
    
</ContentPage>